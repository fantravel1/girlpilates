{{ define "main" }}
<article class="container py-8 lg:py-12">
  <!-- Breadcrumb -->
  <nav class="mb-8 text-sm">
    <ol class="flex flex-wrap items-center gap-2 text-gray-500">
      <li><a href="/" class="hover:text-pink-600">{{ i18n "nav_home" | default "Home" }}</a></li>
      <li><span class="mx-1">/</span></li>
      <li><a href="/learn/" class="hover:text-pink-600">{{ i18n "nav_learn" | default "Learn" }}</a></li>
      {{ with .Parent }}
      {{ if ne .RelPermalink "/learn/" }}
      <li><span class="mx-1">/</span></li>
      <li><a href="{{ .RelPermalink }}" class="hover:text-pink-600">{{ .Title }}</a></li>
      {{ end }}
      {{ end }}
      <li><span class="mx-1">/</span></li>
      <li class="text-gray-900 font-medium">{{ .Title }}</li>
    </ol>
  </nav>

  <!-- Article Header -->
  <header class="max-w-3xl mx-auto mb-8">
    <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4">{{ .Title }}</h1>
    {{ with .Description }}
    <p class="text-xl text-gray-600">{{ . }}</p>
    {{ end }}

    <!-- Meta info -->
    <div class="flex flex-wrap items-center gap-4 mt-6 text-sm text-gray-500">
      {{ with .Params.author }}
      <span class="flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
        </svg>
        {{ . }}
      </span>
      {{ end }}
      {{ with .ReadingTime }}
      <span class="flex items-center gap-1">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        {{ . }} {{ i18n "min_read" | default "min read" }}
      </span>
      {{ end }}
      {{ with .Parent }}
      {{ if ne .RelPermalink "/learn/" }}
      <a href="{{ .RelPermalink }}" class="px-2 py-1 bg-pink-100 text-pink-700 rounded-full text-xs font-medium hover:bg-pink-200 transition-colors">
        {{ .Title }}
      </a>
      {{ end }}
      {{ end }}
    </div>
  </header>

  <!-- Content -->
  <div class="max-w-3xl mx-auto prose prose-lg prose-pink prose-headings:font-bold prose-a:text-pink-600">
    {{ .Content }}
  </div>

  <!-- Table of Contents (if content is long) -->
  {{ if gt (len .Content) 3000 }}
  {{ with .TableOfContents }}
  <aside class="hidden xl:block fixed right-8 top-32 w-64 max-h-[calc(100vh-12rem)] overflow-y-auto text-sm">
    <h4 class="font-semibold text-gray-900 mb-3">{{ i18n "on_this_page" | default "On This Page" }}</h4>
    <nav class="toc text-gray-600">
      {{ . }}
    </nav>
  </aside>
  {{ end }}
  {{ end }}

  <!-- Related Articles -->
  {{ $related := .Site.RegularPages.Related . | first 3 }}
  {{ with $related }}
  <section class="max-w-3xl mx-auto mt-16 pt-8 border-t border-gray-200">
    <h2 class="text-2xl font-bold mb-6">{{ i18n "related" | default "Related Articles" }}</h2>
    <div class="grid gap-6 sm:grid-cols-3">
      {{ range . }}
      <a href="{{ .RelPermalink }}" class="group block bg-white rounded-lg border border-gray-100 p-4 hover:shadow-md hover:border-pink-200 transition-all">
        <h3 class="font-medium text-gray-900 group-hover:text-pink-600 transition-colors mb-2">{{ .Title }}</h3>
        {{ with .Description }}
        <p class="text-sm text-gray-600 line-clamp-2">{{ . }}</p>
        {{ end }}
      </a>
      {{ end }}
    </div>
  </section>
  {{ end }}

  <!-- Navigation between articles -->
  <nav class="max-w-3xl mx-auto mt-12 pt-8 border-t border-gray-200">
    <div class="flex justify-between items-center">
      {{ with .PrevInSection }}
      <a href="{{ .RelPermalink }}" class="flex items-center gap-2 text-gray-600 hover:text-pink-600 transition-colors">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        <span class="hidden sm:inline">{{ .Title | truncate 30 }}</span>
        <span class="sm:hidden">{{ i18n "previous" | default "Previous" }}</span>
      </a>
      {{ else }}
      <span></span>
      {{ end }}

      {{ with .Parent }}
      <a href="{{ .RelPermalink }}" class="px-4 py-2 bg-gray-100 rounded-lg text-gray-700 hover:bg-gray-200 transition-colors text-sm">
        {{ i18n "back_to" | default "Back to" }} {{ .Title }}
      </a>
      {{ end }}

      {{ with .NextInSection }}
      <a href="{{ .RelPermalink }}" class="flex items-center gap-2 text-gray-600 hover:text-pink-600 transition-colors">
        <span class="hidden sm:inline">{{ .Title | truncate 30 }}</span>
        <span class="sm:hidden">{{ i18n "next" | default "Next" }}</span>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </a>
      {{ else }}
      <span></span>
      {{ end }}
    </div>
  </nav>
</article>
{{ end }}
