<script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "GirlPilates",
    "url": "{{ .Site.BaseURL }}",
    "inLanguage": ["en", "es"],
    "description": "The world's most comprehensive free bilingual Pilates resource with 650+ exercises, workouts, and educational content.",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ .Site.BaseURL }}search/?q={search_term}",
      "query-input": "required name=search_term"
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "GirlPilates",
    "url": "{{ .Site.BaseURL }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ "/images/logo.png" | absURL }}",
      "width": 512,
      "height": 512
    },
    "sameAs": [
      "https://www.instagram.com/girlpilates",
      "https://www.pinterest.com/girlpilates",
      "https://www.youtube.com/@girlpilates"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "email": "hello@girlpilates.com",
      "availableLanguage": ["English", "Spanish"]
    }
  }
  {{- if not .IsHome -}},
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "{{ if eq .Language.Lang "es" }}Inicio{{ else }}Home{{ end }}",
        "item": "{{ .Site.BaseURL }}{{ if eq .Language.Lang "es" }}es/{{ end }}"
      }
      {{- $url := "" -}}
      {{- range $i, $seg := split (trim .RelPermalink "/") "/" -}}
        {{- if $seg -}}
          {{- $url = printf "%s/%s" $url $seg -}},
      {
        "@type": "ListItem",
        "position": {{ add $i 2 }},
        "name": "{{ $seg | humanize | title }}",
        "item": "{{ $url | absURL }}/"
      }
        {{- end -}}
      {{- end -}}
    ]
  }
  {{- end -}}

  {{- /* Exercise-specific schema (EN and ES) */ -}}
  {{- if and (or (eq .Section "exercises") (eq .Section "ejercicios")) .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "{{ if eq .Language.Lang "es" }}Cómo hacer {{ .Title }}{{ else }}How to do {{ .Title }}{{ end }}",
    "description": "{{ .Description }}",
    "inLanguage": "{{ .Language.Lang }}",
    {{- with .Params.image -}}
    "image": "{{ . | absURL }}",
    {{- end -}}
    {{- with .Params.duration -}}
    "totalTime": "PT{{ . }}S",
    {{- end -}}
    {{- with .Params.difficulty -}}
    "educationalLevel": "{{ . }}",
    {{- end -}}
    "step": [
      {{- range $i, $step := .Params.steps -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "HowToStep",
        "position": {{ add $i 1 }},
        "text": "{{ $step }}"
      }
      {{- end -}}
    ],
    "tool": [
      {{- range $i, $equip := .Params.equipment -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "HowToTool",
        "name": "{{ $equip }}"
      }
      {{- end -}}
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "ExerciseAction",
    "name": "{{ .Title }}",
    "description": "{{ .Description }}",
    "exerciseType": "Pilates",
    {{- with .Params.muscles -}}
    "exerciseCourse": {
      "@type": "ExercisePlan",
      "name": "{{ $.Title }}",
      "activityFrequency": "As needed"
    }
    {{- end -}}
  }
  {{- with .Params.video_id -}},
  {
    "@context": "https://schema.org",
    "@type": "VideoObject",
    "name": "{{ $.Title }}",
    "description": "{{ $.Description }}",
    "thumbnailUrl": "https://i.ytimg.com/vi/{{ . }}/maxresdefault.jpg",
    "uploadDate": "{{ $.Date.Format "2006-01-02" }}",
    "embedUrl": "https://www.youtube-nocookie.com/embed/{{ . }}",
    "inLanguage": "{{ $.Language.Lang }}"
  }
  {{- end -}}
  {{- end -}}

  {{- /* Workout Program schema (EN and ES) */ -}}
  {{- if and (or (eq .Section "workouts") (eq .Section "entrenamientos")) .IsPage -}},
  {{- /* Check if this is a premade workout with workout_id */ -}}
  {{- $workoutData := dict -}}
  {{- $isPremade := false -}}
  {{- with .Params.workout_id -}}
    {{- $premade := site.Data.premade_workouts -}}
    {{- $workout := index (where $premade.workouts "id" .) 0 -}}
    {{- if $workout -}}
      {{- $workoutData = $workout -}}
      {{- $isPremade = true -}}
    {{- end -}}
  {{- end -}}
  {
    "@context": "https://schema.org",
    "@type": "ExercisePlan",
    "name": "{{ .Title }}",
    "description": "{{ .Description }}",
    "inLanguage": "{{ .Language.Lang }}",
    {{- if $isPremade -}}
    "activityDuration": "PT{{ $workoutData.duration }}M",
    "intensity": "{{ $workoutData.difficulty }}",
    "exerciseType": [
      {{- range $i, $equip := $workoutData.equipment -}}
      {{- if $i -}},{{- end -}}
      "{{ $equip }} Pilates"
      {{- end -}}
    ],
    {{- if $workoutData.calories -}}
    "workload": "{{ $workoutData.calories }} calories",
    {{- end -}}
    {{- else -}}
    {{- with .Params.duration -}}
    "activityDuration": "PT{{ . }}M",
    {{- end -}}
    {{- with .Params.difficulty -}}
    "intensity": "{{ . }}",
    {{- end -}}
    {{- with .Params.equipment -}}
    "exerciseType": [
      {{- range $i, $equip := . -}}
      {{- if $i -}},{{- end -}}
      "{{ $equip }} Pilates"
      {{- end -}}
    ],
    {{- end -}}
    {{- end -}}
    "author": {
      "@type": "Organization",
      "name": "GirlPilates"
    },
    "datePublished": "{{ .Date.Format "2006-01-02" }}",
    "provider": {
      "@type": "Organization",
      "name": "GirlPilates",
      "url": "{{ .Site.BaseURL }}"
    }
  }
  {{- /* Add HowTo schema for premade workouts with step-by-step instructions */ -}}
  {{- if $isPremade -}},
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "{{ if eq .Language.Lang "es" }}Cómo hacer {{ .Title }}{{ else }}How to do {{ .Title }}{{ end }}",
    "description": "{{ .Description }}",
    "totalTime": "PT{{ $workoutData.duration }}M",
    "estimatedCost": {
      "@type": "MonetaryAmount",
      "currency": "USD",
      "value": "0"
    },
    "tool": [
      {{- range $i, $equip := $workoutData.equipment -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "HowToTool",
        "name": "{{ $equip | humanize }}"
      }
      {{- end -}}
    ],
    "step": [
      {
        "@type": "HowToStep",
        "position": 1,
        "name": "{{ if eq $.Language.Lang "es" }}Calentamiento{{ else }}Warm-Up{{ end }}",
        "text": "{{ if eq $.Language.Lang "es" }}Prepara tu cuerpo con estiramientos suaves y respiración profunda{{ else }}Prepare your body with gentle stretches and deep breathing{{ end }}"
      },
      {
        "@type": "HowToStep",
        "position": 2,
        "name": "{{ if eq $.Language.Lang "es" }}Entrenamiento Principal{{ else }}Main Workout{{ end }}",
        "text": "{{ .Description }}"
      },
      {
        "@type": "HowToStep",
        "position": 3,
        "name": "{{ if eq $.Language.Lang "es" }}Enfriamiento{{ else }}Cool-Down{{ end }}",
        "text": "{{ if eq $.Language.Lang "es" }}Termina con estiramientos suaves y respiración profunda{{ else }}Finish with gentle stretches and deep breathing{{ end }}"
      }
    ],
    "supply": [
      {
        "@type": "HowToSupply",
        "name": "{{ if eq $.Language.Lang "es" }}Ropa cómoda{{ else }}Comfortable clothing{{ end }}"
      },
      {
        "@type": "HowToSupply",
        "name": "{{ if eq $.Language.Lang "es" }}Agua{{ else }}Water{{ end }}"
      }
    ]
  }
  {{- end -}}
  {{- end -}}

  {{- /* FAQ schema - parse from content */ -}}
  {{- if or (eq .Params.layout "faq") (in .RelPermalink "faq") (in .RelPermalink "preguntas") -}},
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {{- $content := .RawContent -}}
      {{- $questions := findRE "###\\s+(.+?)\\n" $content -}}
      {{- range $i, $q := $questions -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "Question",
        "name": "{{ $q | replaceRE "###\\s+" "" | replaceRE "\\n" "" }}",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "See full answer on page."
        }
      }
      {{- end -}}
    ],
    "inLanguage": "{{ .Language.Lang }}"
  }
  {{- end -}}

  {{- /* Article schema for learn section (EN and ES) */ -}}
  {{- if and (or (eq .Section "learn") (eq .Section "aprender")) .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ .Title }}",
    "description": "{{ .Description }}",
    "inLanguage": "{{ .Language.Lang }}",
    "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
    "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
    "author": {
      "@type": "Organization",
      "name": "GirlPilates",
      "url": "{{ .Site.BaseURL }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "GirlPilates",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ "/images/logo.png" | absURL }}",
        "width": 512,
        "height": 512
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ .Permalink }}"
    },
    "articleSection": "{{ .Section | title }}",
    "wordCount": {{ .WordCount }}
  }
  {{- end -}}

  {{- /* Glossary schema */ -}}
  {{- if or (in .RelPermalink "glossary") (in .RelPermalink "glosario") -}},
  {
    "@context": "https://schema.org",
    "@type": "DefinedTermSet",
    "name": "{{ .Title }}",
    "description": "{{ .Description }}",
    "inLanguage": "{{ .Language.Lang }}"
  }
  {{- end -}}

  {{- /* Person schema for teachers (EN and ES) */ -}}
  {{- if and (or (eq .Section "teachers") (eq .Section "profesores")) .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "{{ .Title }}",
    "jobTitle": "{{ if eq .Language.Lang "es" }}Instructor de Pilates{{ else }}Pilates Instructor{{ end }}",
    "description": "{{ .Description }}"
    {{- with .Params.photo -}},
    "image": "{{ . | absURL }}"
    {{- end -}}
    {{- with .Params.certifications -}},
    "hasCredential": [
      {{- range $i, $cert := . -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "EducationalOccupationalCredential",
        "name": "{{ $cert }}"
      }
      {{- end -}}
    ]
    {{- end -}}
    {{- with .Params.specialty -}},
    "knowsAbout": [
      {{- range $i, $spec := . -}}
      {{- if $i -}},{{- end -}}
      "{{ $spec }}"
      {{- end -}}
    ]
    {{- end -}}
  }
  {{- end -}}

  {{- /* Collection page schema for list pages */ -}}
  {{- if and .IsSection (not .IsHome) -}},
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "{{ .Title }}",
    "description": "{{ .Description }}",
    "inLanguage": "{{ .Language.Lang }}",
    "url": "{{ .Permalink }}",
    "numberOfItems": {{ len .RegularPages }},
    "mainEntity": {
      "@type": "ItemList",
      "numberOfItems": {{ len .RegularPages }},
      "itemListElement": [
        {{- range $i, $page := first 10 .RegularPages -}}
        {{- if $i -}},{{- end -}}
        {
          "@type": "ListItem",
          "position": {{ add $i 1 }},
          "url": "{{ $page.Permalink }}",
          "name": "{{ $page.Title }}"
        }
        {{- end -}}
      ]
    }
  }
  {{- end -}}
]
</script>
