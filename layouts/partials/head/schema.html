<script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "GirlPilates",
    "url": "{{ .Site.BaseURL }}",
    "inLanguage": ["en", "es"],
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ .Site.BaseURL }}search/?q={search_term}",
      "query-input": "required name=search_term"
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "GirlPilates",
    "url": "{{ .Site.BaseURL }}",
    "logo": "{{ "/images/logo.png" | absURL }}",
    "sameAs": [
      {{ with .Site.Params.social.youtube }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.youtube .Site.Params.social.instagram }},{{ end }}
      {{ with .Site.Params.social.instagram }}"{{ . }}"{{ end }}
    ]
  }
  {{- if not .IsHome -}},
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ .Site.BaseURL }}"
      }
      {{- $url := "" -}}
      {{- range $i, $seg := split (trim .RelPermalink "/") "/" -}}
        {{- if $seg -}}
          {{- $url = printf "%s/%s" $url $seg -}},
      {
        "@type": "ListItem",
        "position": {{ add $i 2 }},
        "name": "{{ $seg | humanize | title }}",
        "item": "{{ $url | absURL }}/"
      }
        {{- end -}}
      {{- end -}}
    ]
  }
  {{- end -}}

  {{- /* Exercise-specific schema */ -}}
  {{- if and (eq .Section "exercises") .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "{{ i18n "how_to_do" }} {{ .Title }}",
    "description": "{{ .Description }}",
    {{- with .Params.image -}}
    "image": "{{ . | absURL }}",
    {{- end -}}
    {{- with .Params.duration -}}
    "totalTime": "PT{{ div . 60 }}M",
    {{- end -}}
    "step": [
      {{- range $i, $step := .Params.steps -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "HowToStep",
        "position": {{ add $i 1 }},
        "text": "{{ $step }}"
      }
      {{- end -}}
    ]
  },
  {
    "@context": "https://schema.org",
    "@type": "ExerciseAction",
    "name": "{{ .Title }}",
    "description": "{{ .Description }}",
    "exerciseType": "Pilates"
  }
  {{- with .Params.video_id -}},
  {
    "@context": "https://schema.org",
    "@type": "VideoObject",
    "name": "{{ $.Title }}",
    "description": "{{ $.Description }}",
    "thumbnailUrl": "https://i.ytimg.com/vi/{{ . }}/maxresdefault.jpg",
    "uploadDate": "{{ $.Date.Format "2006-01-02" }}",
    "embedUrl": "https://www.youtube-nocookie.com/embed/{{ . }}"
  }
  {{- end -}}
  {{- end -}}

  {{- /* FAQ schema */ -}}
  {{- with .Params.faq -}},
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {{- range $i, $item := . -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "Question",
        "name": "{{ $item.q }}",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "{{ $item.a }}"
        }
      }
      {{- end -}}
    ]
  }
  {{- end -}}

  {{- /* Article schema for learn section */ -}}
  {{- if and (eq .Section "learn") .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ .Title }}",
    "description": "{{ .Description }}",
    "datePublished": "{{ .Date.Format "2006-01-02" }}",
    "dateModified": "{{ .Lastmod.Format "2006-01-02" }}",
    "author": {
      "@type": "Person",
      "name": "{{ with .Params.author }}{{ . }}{{ else }}GirlPilates Team{{ end }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "GirlPilates",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ "/images/logo.png" | absURL }}"
      }
    }
  }
  {{- end -}}

  {{- /* Person schema for teachers */ -}}
  {{- if and (eq .Section "teachers") .IsPage -}},
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "{{ .Title }}",
    "jobTitle": "Pilates Instructor",
    "description": "{{ .Description }}"
    {{- with .Params.photo -}},
    "image": "{{ . | absURL }}"
    {{- end -}}
    {{- with .Params.certifications -}},
    "hasCredential": [
      {{- range $i, $cert := . -}}
      {{- if $i -}},{{- end -}}
      {
        "@type": "EducationalOccupationalCredential",
        "name": "{{ $cert }}"
      }
      {{- end -}}
    ]
    {{- end -}}
  }
  {{- end -}}
]
</script>
